<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<title>renshuu layout</title>
	<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<link rel="icon" type="image/ico" href="favicon.ico" />
	<link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />
	<link type="text/css" href="css/main.css" rel="stylesheet" />
	<link type="text/css" href="css/autoSuggest.css" rel="stylesheet" />
	<link type="text/css" href="css/jquery.clockpick.1.2.7.css" rel="stylesheet" />
	<link type="text/css" href="css/ui.timepickr.css" rel="stylesheet" />
	
	  <style>
  #infoPanel {
    float: left;
    margin-left: 10px;
  }
  #infoPanel div {
    margin-bottom: 5px;
  }
  </style>

	<script type="text/javascript" src="http://maps.google.com/maps/api/js?v=3.1&amp;sensor=false&amp;language=ja"></script>

	<script type="text/javascript" src="js/jquery.js"></script>
	<script type="text/javascript" src="js/jquery.ui.core.js"></script>
	<script type="text/javascript" src="js/jquery.ui.widget.js"></script>
	<script type="text/javascript" src="js/jquery.ui.tabs.js"></script>
	
	<script type="text/javascript" src="js/jquery.timepicker.js"></script>
	<script type="text/javascript" src="js/jquery.clockpick.1.2.7.js"></script>
	
	<script type="text/javascript" src="js/ui.timepickr.js"></script>
	
	<script type="text/javascript" src="js/jquery.inputnotes-0.6.js"></script>

	<script type="text/javascript" src="js/jquery.cookie.js"></script>
	
	<script type="text/javascript" src="js/jquery.json-2.2.js"></script>
	<script type="text/javascript" src="js/jstorage.js"></script>

	<script type="text/javascript" src="js/jquery.curvycorners.js"></script>
	<script type="text/javascript" src="js/jquery.autoSuggest.js"></script>

	<script type="text/javascript" src="js/jquery.simplemodal-1.3.5.js"></script>
	
	<script type="text/javascript" src="js/jquery.ba-hashchange.js"></script>
	
	<script type="text/javascript" src="js/renshuusurutoki.js"></script>

	<script type="text/javascript">

function updateMarkerStatus(str) {
	$('#markerStatus').html(str);
}

function updateMarkerPosition(latLng) {
	$('#info').html('lat: ' + latLng.lat() + ', lng: ' + latLng.lng());
}

function updateMarkerAddress(str) {
	$('#address').html(str);
}

		$(document).ready(function() {
			
			var latLng = $.reshuuSuruToki.map.getCenter();
			var marker = $.reshuuSuruToki.markers.createMarker(latLng, 'Point A', $.reshuuSuruToki.pins.gYellowIcon(), true);

			// Update current position info.
			updateMarkerPosition(latLng);
			$.reshuuSuruToki.data.geocodePosition(latLng);

			google.maps.event.addListener(marker, 'drag', function() {
				updateMarkerStatus('Dragging...');
				updateMarkerPosition(marker.getPosition());
			});
			google.maps.event.addListener(marker, 'dragend', function() {
				marker.setOptions({icon: $.reshuuSuruToki.pins.gYellowIcon()});
				updateMarkerStatus('Drag ended');
				$.reshuuSuruToki.data.geocodePosition(marker.getPosition());

				$.reshuuSuruToki.streetview.setPosition(marker.getPosition());
				$.reshuuSuruToki.streetview.setVisible(true);
			});

			$('#list li a').click(function() {
				var attr = { type: $(this).parent().attr('') };
				$.get(ajaxpoint.get + 'location/' + $(this).attr('rev'), attr, function(data, status) {
					var len = data.response.length;
					for (var i = 0; i < len; ++i) {
						var item = data.response[i];
						var icon = 'http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=' + encodeURI(item.name.substr(0, 1)) + '|AA0000|FCFCFC&chof=png';
						console.log("icon: " + icon);
						
					}
				}, 'json');
				return false;
			});

			$('#new_location').click(function() {
				createLocation();
				return false;
			});
		});

		function createLocation() {
			$('<div></div>').html('Select a position from the map by clicking it.').dialog({
				title: "Create a new location",
				width: 400,
				height: 300,
				buttons: {
					"Ok": function() {
						var location = {
							latitude: lat,
							longitude: lng
						};
						$.post(ajaxpoint.set + 'location', location, function(data, status) {
							$(this).dialog("close");
						}, 'json');
					}
				}
			});
		}

		/**
		* @param target The select element as jQuery object
		* @param type String defining the type of the data to be fetched
		*/
		function loadOptions(target, type) {
			var append = '';
			$.get(ajaxpoint.get + type, {}, function(data, status) {
				var len = data.response.length;
				for (var i = 0; i < len; ++i) {
					var item = data.response[i];
					append += '<' + 'option value="' + item.id + '">' + item.title + '<' + '/option>';
				}
				target.children('option').replace(append);
			});
		}



		// http://code.google.com/apis/maps/documentation/javascript/reference.html#GeocoderStatus
		// http://marcgrabanski.com/articles/jquery-google-maps-tutorial-ajax-php-mysql

		function geoEncode() {
			var address = $("#add-point input[name=address]").val();
			geo.getLocations(address, function(result){
			if (result.Status.code == G_GEO_SUCCESS) {
				geocode = result.Placemark[0].Point.coordinates; savePoint(geocode);
			}
			else {
				var reason="Code"+result.Status.code;
				if (reasons[result.Status.code]) {
				reason = reasons[result.Status.code]
			}
			$("#add-point .error").html(reason).fadeIn();
				geocode = false;
			}
			});
		}


		$(document).ready(function() {
		
			$('#post_data').click(function() {
				$.reshuuSuruToki.updateLocations();
				
				return false;
			});
			
			

		});

/*
2010-07-27
Disturbed: Another way to die

28
Rammstein: ich tu dir weh
Bullet for my valentine: the last fight
*/
	</script>
</head>
<body>
	<div id="wrap" class="round">
		<div id="left">
			<div id="mapping">
				<div class="header qr_training">
					<p><a href="#" rel="map">Training locations</a><span></span></p>
				</div>
				<div class="content">
					<div id="map" class="stuff">Google Maps V3</div>
				</div>
				<div class="header qr_street">
					<p><a href="#" rel="street">Street View</a><span></span></p>
				</div>
				<div class="content">
					<div id="street" class="stuff">Google Maps Street View</div>
				</div>
			</div>
		</div>
		
		<div id="right">
		
		
			<script type="text/javascript">
				$(document).ready(function() {
					$('#tabs > div:first').tabs({
						add: null,
						ajaxOptions: {
							error: function(xhr, status, index, anchor) {
								$(anchor.hash).html("Couldn't load this tab. We'll try to fix this as soon as possible. If this wouldn't be a demo.");
							}
						},
						cache: false,
						cookie: {
							// store cookie for a day, without, it would be a session cookie
							expires: 1
						}, // e.g. { expires: 7, path: '/', domain: 'jquery.com', secure: true }
						collapsible: false,
						disable: null,
						disabled: [],
						enable: null,
						event: 'click',
						fx: null, // e.g. { height: 'toggle', opacity: 'toggle', duration: 200 }
						idPrefix: 'ui-tabs-',
						load: null,
						panelTemplate: '<div></div>',
						remove: null,
						select: null,
						show: null,
						spinner: '<em>Loading&#8230;</em>',
						tabTemplate: '<li><a href="#{href}"><span>#{label}</span></a></li>'
					});

				});
			</script>
			<div id="tabs">
				<div class="header qr_tools">
					<ul>
						<li><a href="#filters" class="active">filters</a></li>
						<li><a href="#forms">forms</a></li>
						<li><a href="#profile">profile</a></li>
					</ul>
					<span></span>
				</div>
				<div class="content">
					<div class="stuff">
						<!-- -->
					</div>
				</div>
			</div>
		
			<div id="tools">
				<div class="header qr_tools">
					<p><a href="#" rel="tools">Tools</a><span></span></p>
				</div>
				<div class="content">
					<div class="stuff">
						<p><a href="#" id="new_location">Create a new location</a></p>
						<p><a href="#" id="post_data">Post data test</a></p>
					</div>
				</div>
			</div>
			
			<div id="forms">
				<div class="header qr_forms">
					<p><a href="#" rel="forms">Forms</a><span></span></p>
				</div>
				<div class="content">
					<div class="stuff">
					</div>
				</div>
			</div>
			
			<div id="profile">
				<div class="header qr_profile">
					<p><a href="#" rel="profile">Profile</a><span></span></p>
				</div>
				<div class="content">
					<div class="stuff">
					</div>
				</div>
			</div>
			
			<div id="filters">
				<div class="header qr_arts">
					<p><a href="#" rel="arts">Martial Arts</a><span></span></p>
				</div>
				<div class="content">
					<div class="stuff">
						<p rel="arts">
							<a href="#" rel="all" title="Select all">Select all</a>
							<a href="#" rel="none" title="Select none">Select none</a>
							<a href="#" rel="inverse" title="Inverse selection">Inverse selection</a>
						</p>
						<ul id="arts">
							<li><label><input type="checkbox" name="art_2" /> 琉球古武術保存振興会</label></li>
							<li><label><input type="checkbox" name="art_1" /> 直心影流薙刀術</label></li>			
						</ul>
					</div>
				</div>
				
				<div class="header qr_weekdays">
					<p><a href="#" rel="weekdays">Weekdays</a><span></span></p>
				</div>
				<div class="content">
					<div class="stuff">
						<p rel="weekdays">
							<a href="#" rel="all" title="Select all">Select all</a>
							<a href="#" rel="none" title="Select none">Select none</a>
							<a href="#" rel="inverse" title="Inverse selection">Inverse selection</a>
						</p>
						<ul id="weekdays">
							<li><label><input type="checkbox" name="day_0" /> 日</label></li>
							<li><label><input type="checkbox" name="day_1" /> 月</label></li>
							<li><label><input type="checkbox" name="day_2" /> 火</label></li>
							<li><label><input type="checkbox" name="day_3" /> 水</label></li>
							<li><label><input type="checkbox" name="day_4" /> 木</label></li>
							<li><label><input type="checkbox" name="day_5" /> 金</label></li>
							<li><label><input type="checkbox" name="day_6" /> 土</label></li>
						</ul>
					</div>
				</div>

			</div>
		</div>
		
	</div>

	<div id="bottom" class="round">

		<div id="infoPanel">
			<b>Marker status:</b>
			<div id="markerStatus"><i>Click and drag the marker.</i></div>
			<b>Current position:</b>
			<div id="info"></div>
			<b>Closest matching address:</b>
			<div id="address"></div>
			<a href="#" id="get_bounds">get bounds</a>
		</div>

	</div>

</body>
</html>
